<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-如何建立自己的博客" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/06/13/%E5%A6%82%E4%BD%95%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/" class="article-date">
  <time datetime="2022-06-13T11:10:08.210Z" itemprop="datePublished">2022-06-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="如何建立自己的博客"><a href="#如何建立自己的博客" class="headerlink" title="如何建立自己的博客"></a>如何建立自己的博客</h1><p>博客：叫博客是英译过来的，定期以文字、图片等形式发布的，通常由新到旧排列的帖子所组成的，由个人管理的网页或网站。</p>
<hr>
<h2 id="使用Hexo"><a href="#使用Hexo" class="headerlink" title="使用Hexo"></a>使用Hexo</h2><p>hexo是一个可以帮你快速建立个人博客的一个工具！</p>
<p>朋友推荐的，使用感受还有待体验！</p>
<p>官方网站：<a target="_blank" rel="noopener" href="https://hexo.io/">https://hexo.io</a> </p>
<h2 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h2><h3 id="安装前提"><a href="#安装前提" class="headerlink" title="安装前提"></a>安装前提</h3><p>安装之前先要安装下面两个应用 </p>
<ul>
<li><a target="_blank" rel="noopener" href="http://nodejs.org/">Node.js</a> </li>
<li><a target="_blank" rel="noopener" href="http://git-scm.com/">Git</a></li>
</ul>
<ol>
<li><p>去node.js官方网站下载exe安装包安装即可：<a target="_blank" rel="noopener" href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></p>
<p><img src="D:\我的数据\笔记\Typora笔记库\hexo安装\image\2ba329c3d3214fca47d74c204bc8065.png"></p>
<p>安装完成之后可以使用 Windows Power Shell 检查</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure>

<p><img src="D:\我的数据\笔记\Typora笔记库\hexo安装\image\6c31020b62c7804fc4b541020e55ba6.png" alt="6c31020b62c7804fc4b541020e55ba6"></p>
</li>
<li><p>去Git官方网站下载exe安装包安装即可：<a target="_blank" rel="noopener" href="https://git-scm.com/download/win">https://git-scm.com/download/win</a></p>
<p><img src="D:\我的数据\笔记\Typora笔记库\hexo安装\image\0fdd08a9e6e03ee9bdce913cc0f8fcb.png" alt="0fdd08a9e6e03ee9bdce913cc0f8fcb"></p>
</li>
</ol>
<h3 id="部署Hexo"><a href="#部署Hexo" class="headerlink" title="部署Hexo"></a>部署Hexo</h3><ol>
<li><p>我们通过包管理器npm来安装hexo,但由于源是国外的访问很慢。在之前先添加国内镜像再安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装hexo</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cnpm install -g hexo-cli</span><br><span class="line">hexo -v   #检查版本</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">将 Hexo 所在的目录下的 node_modules 添加到环境变量之中即可直接使用 hexo &lt;<span class="built_in">command</span>&gt;</span></span><br><span class="line">echo &#x27;PATH=&quot;$PATH:./node_modules/.bin&quot;&#x27; &gt;&gt; ~/.profile   </span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化hexo，需要在你的电脑里指定一个空文件夹，Hexo 将会在指定文件夹中新建所需要的文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo init &lt;folder&gt;</span><br><span class="line">cd &lt;folder&gt;</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>
</li>
<li><p>​	开启hexo</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<p><img src="D:\我的数据\笔记\Typora笔记库\hexo安装\image\fd68503efeb50df773881d740399c7d.png" alt="fd68503efeb50df773881d740399c7d"></p>
</li>
<li><p>访问</p>
<p><a target="_blank" rel="noopener" href="http://localhost:4000/">http://localhost:4000/</a></p>
<p><img src="C:\Users\21465\AppData\Roaming\Typora\typora-user-images\image-20220613190758406.png" alt="image-20220613190758406"></p>
</li>
</ol>
<h3 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h3><p>   这只是博客的本地化生成后面还有很多工作要做！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/13/%E5%A6%82%E4%BD%95%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/" data-id="cl4f47vu00000dog9hrp64z19" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-docker笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/06/13/docker%E7%AC%94%E8%AE%B0/" class="article-date">
  <time datetime="2022-06-13T08:30:34.312Z" itemprop="datePublished">2022-06-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>​	</p>
<h1 id="docker笔记"><a href="#docker笔记" class="headerlink" title="docker笔记"></a>docker笔记</h1><h1 id="docker-的基本组成"><a href="#docker-的基本组成" class="headerlink" title="docker 的基本组成"></a>docker 的基本组成</h1><p><img src="https://img-blog.csdnimg.cn/20210112223441225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1MjIzMTU5NTc0Mg==,size_16,color_FFFFFF,t_70" alt="img"></p>
<ul>
<li><p>镜像（image）</p>
<p>镜像里面有打包好的服务、代码、技术栈，通过镜像&#x3D;&#x3D;&#x3D;&gt;run&#x3D;&#x3D;&#x3D;&gt;容器（提供服务），而且一个镜像可以创建多个服务。</p>
</li>
<li><p>容器（container)</p>
<p>容器技术：笔记做下来比较多，这里就不解释了。</p>
<p>docker通过使用容器技术，运行一个或一组应用，通过镜像来创建</p>
<p>操作：启动   停止   删除   （这些基础操作）</p>
<p>狂神说：目前把容器理解成一个简易的linux。</p>
<p>（”狂神说“ 我docker的导师）</p>
</li>
<li><p>仓库（repository)</p>
<p>仓库是放镜像的地方！</p>
<p>Docker Hub:是国外的镜像仓库</p>
<p>阿里云等等一些国内的厂商或个人，都有容器服务器（配置容器加速器</p>
</li>
</ul>
<h1 id="Docker-install"><a href="#Docker-install" class="headerlink" title="Docker install"></a>Docker install</h1><h2 id="在线安装"><a href="#在线安装" class="headerlink" title="在线安装"></a>在线安装</h2><ol>
<li><p>环境准备，我使用的是centos</p>
<ol>
<li><p>~~~shell<br>[root@localhost ~]# uname -r<br>3.10.0-957.el7.x86_64   #要求3.0以上</p>
<p>[root@localhost ~]# cat &#x2F;etc&#x2F;os-release<br>NAME&#x3D;”CentOS Linux”<br>VERSION&#x3D;”7 (Core)”<br>ID&#x3D;”centos”<br>ID_LIKE&#x3D;”rhel fedora”<br>VERSION_ID&#x3D;”7”<br>PRETTY_NAME&#x3D;”CentOS Linux 7 (Core)”<br>ANSI_COLOR&#x3D;”0;31”<br>CPE_NAME&#x3D;”cpe:&#x2F;o:centos:centos:7”<br>HOME_URL&#x3D;”<a target="_blank" rel="noopener" href="https://www.centos.org/&quot;">https://www.centos.org/&quot;</a><br>BUG_REPORT_URL&#x3D;”<a target="_blank" rel="noopener" href="https://bugs.centos.org/&quot;">https://bugs.centos.org/&quot;</a></p>
<p>CENTOS_MANTISBT_PROJECT&#x3D;”CentOS-7”<br>CENTOS_MANTISBT_PROJECT_VERSION&#x3D;”7”<br>REDHAT_SUPPORT_PRODUCT&#x3D;”centos”<br>REDHAT_SUPPORT_PRODUCT_VERSION&#x3D;”7”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. 安装</span><br><span class="line"></span><br><span class="line">   帮助文档：https://docs.docker.com/engine/install/</span><br><span class="line"></span><br><span class="line">   ~~~shell</span><br><span class="line">   #需要的安装包</span><br><span class="line">   yum install -y yum-utils</span><br><span class="line">   </span><br><span class="line">   #设置镜像仓库</span><br><span class="line">   yum-config-manager \</span><br><span class="line">       --add-repo \</span><br><span class="line">       https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">   #默认是部署国外的镜像仓库，不推荐</span><br><span class="line">   #推荐使用国内的</span><br><span class="line">   yum-config-manager \</span><br><span class="line">       --add-repo \</span><br><span class="line">       https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">   #更新软件包索引</span><br><span class="line">   yum makecache fast</span><br><span class="line">   #安装docker相关的 docker-ce社区版，docker-ee是企业版</span><br><span class="line">   yum install docker-ce docker-ce-cli containerd.io</span><br><span class="line">   #z</span><br><span class="line">   yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io</span><br><span class="line">   #启动docker</span><br><span class="line">   systemctl start docker</span><br><span class="line">   #使用docker version查看是否安装成功</span><br><span class="line">   docker version</span><br><span class="line">   #使用hello-world镜像测试</span><br><span class="line">   [root@localhost ~]# docker run hello-world</span><br><span class="line">   </span><br><span class="line">   Hello from Docker!</span><br><span class="line">   This message shows that your installation appears to be working correctly.</span><br><span class="line">   </span><br><span class="line">   To generate this message, Docker took the following steps:</span><br><span class="line">    1. The Docker client contacted the Docker daemon.</span><br><span class="line">    2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.</span><br><span class="line">       (amd64)</span><br><span class="line">    3. The Docker daemon created a new container from that image which runs the</span><br><span class="line">       executable that produces the output you are currently reading.</span><br><span class="line">    4. The Docker daemon streamed that output to the Docker client, which sent it</span><br><span class="line">       to your terminal.</span><br><span class="line">   </span><br><span class="line">   To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line">    $ docker run -it ubuntu bash</span><br><span class="line">   </span><br><span class="line">   Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line">    https://hub.docker.com/</span><br><span class="line">   </span><br><span class="line">   For more examples and ideas, visit:</span><br><span class="line">    https://docs.docker.com/get-started/</span><br><span class="line">    #查看一下这个hello-world镜像</span><br><span class="line">    [root@localhost ~]# docker images</span><br><span class="line">   REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">   hello-world   latest    feb5d9fea6a5   2 months ago   13.3kB</span><br><span class="line">   centos        latest    5d0da3dc9764   2 months ago   231MB</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>删除Docker</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除依赖</span></span><br><span class="line">yum remove docker-ce docker-ce-cli containerd.io</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">删除资源</span></span><br><span class="line">rm -rf /var/lib/docker   </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">/var/lib/docker 是docker的默认工作路径！</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="离线安装"><a href="#离线安装" class="headerlink" title="离线安装"></a>离线安装</h2><p>1、在官网下载合适的安装包，我这里用的是4.9.22</p>
<p>下载地址：<a target="_blank" rel="noopener" href="https://download.docker.com/linux/static/stable/x86_64/">https://download.docker.com/linux/static/stable/x86_64/</a></p>
<p>2、使用工具传输到机器上。</p>
<p>3、解压安装包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf docker-20.10.9.tgz</span><br></pre></td></tr></table></figure>

<p>输入为：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker/</span><br><span class="line">docker/containerd-shim-runc-v2</span><br><span class="line">docker/dockerd</span><br><span class="line">docker/docker-proxy</span><br><span class="line">docker/ctr</span><br><span class="line">docker/docker</span><br><span class="line">docker/runc</span><br><span class="line">docker/containerd-shim</span><br><span class="line">docker/docker-init</span><br><span class="line">docker/containerd</span><br></pre></td></tr></table></figure>

<p>4、进入docker目录，将目录下的所有文件拷贝至“&#x2F;usr&#x2F;bin&#x2F;”</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cd docker</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看下docker文件</span></span><br><span class="line">ll</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">输出为：</span></span><br><span class="line">总用量 200840</span><br><span class="line">-rwxr-xr-x. 1 1000 1000 33908392 10月  5 00:08 containerd</span><br><span class="line">-rwxr-xr-x. 1 1000 1000  6508544 10月  5 00:08 containerd-shim</span><br><span class="line">-rwxr-xr-x. 1 1000 1000  8609792 10月  5 00:08 containerd-shim-runc-v2</span><br><span class="line">-rwxr-xr-x. 1 1000 1000 21131264 10月  5 00:08 ctr</span><br><span class="line">-rwxr-xr-x. 1 1000 1000 52883616 10月  5 00:08 docker</span><br><span class="line">-rwxr-xr-x. 1 1000 1000 64758736 10月  5 00:08 dockerd</span><br><span class="line">-rwxr-xr-x. 1 1000 1000   708616 10月  5 00:08 docker-init</span><br><span class="line">-rwxr-xr-x. 1 1000 1000  2784145 10月  5 00:08 docker-proxy</span><br><span class="line">-rwxr-xr-x. 1 1000 1000 14352296 10月  5 00:08 runc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">拷贝至 /usr/bin/:是你在后期安装的一些软件的运行脚本</span></span><br><span class="line">cp * /usr/bin/</span><br></pre></td></tr></table></figure>

<p>5、执行“vim &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;docker.service”命令，然后在文件中添加以下内容，然后按“esc”，退出编辑状态，输入“：qw”退出文件编辑。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Docker Application Container Engine</span><br><span class="line">Documentation=https://docs.docker.com</span><br><span class="line">After=network-online.target firewalld.service</span><br><span class="line">Wants=network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=notify</span><br><span class="line">ExecStart=/usr/bin/dockerd</span><br><span class="line">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="line">LimitNOFILE=infinity</span><br><span class="line">LimitNPROC=infinity</span><br><span class="line">TimeoutStartSec=0</span><br><span class="line">Delegate=yes</span><br><span class="line">KillMode=process</span><br><span class="line">Restart=on-failure</span><br><span class="line">StartLimitBurst=3</span><br><span class="line">StartLimitInterval=60s</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>6、给文件增加可执行权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /etc/systemd/system/docker.service</span><br><span class="line">systemctl daemon-reload </span><br></pre></td></tr></table></figure>

<p>7、启动docker</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker.service</span><br><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure>

<p>8、测试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker -v</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">输出为：</span></span><br><span class="line">Docker version 20.10.9, build c2ea9bc</span><br></pre></td></tr></table></figure>

<h1 id="镜像加速器"><a href="#镜像加速器" class="headerlink" title="镜像加速器"></a>镜像加速器</h1><ol>
<li><p>登录阿里云</p>
</li>
<li><p>找到【容器镜像服务】下面的镜像加速器</p>
<p> 备注：加速地址是唯一的，每一个账户都有自己唯一的加速地址。</p>
</li>
</ol>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211125104452665.png" alt="image-20211125104452665"></p>
<p>3、配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker   #创建一个文件夹   -p：帮助你直接将所需要的目录(包含上一级目录)递归创建起来！</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://dy41zjzf.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload    #重新加载进程</span><br><span class="line">sudo systemctl restart docker   #重启docker</span><br></pre></td></tr></table></figure>

<h1 id="回顾Hello-world流程图"><a href="#回顾Hello-world流程图" class="headerlink" title="回顾Hello-world流程图"></a>回顾Hello-world流程图</h1><p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211126100622281.png" alt="image-20211126100622281"></p>
<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><p>帮助命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version #显示docker的版本信息。</span><br><span class="line">docker info #显示docker的系统信息，包括镜像和容器的数量</span><br><span class="line">docker 命令 --help #帮助命令</span><br></pre></td></tr></table></figure>

<p>帮助文档的地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/docker/">https://docs.docker.com/engine/reference/commandline/docker/</a></p>
<h1 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker images #查看所有本地主机上的镜像 可以使用docker image ls代替</span><br><span class="line">docker search 搜索镜像</span><br><span class="line">docker pull 下载镜像 docker image pull</span><br><span class="line">docker rmi 删除镜像 docker image rm</span><br></pre></td></tr></table></figure>

<h2 id="Docker-images查看本地仓库镜像"><a href="#Docker-images查看本地仓库镜像" class="headerlink" title="Docker images查看本地仓库镜像"></a>Docker images查看本地仓库镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@localhost ~]# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    feb5d9fea6a5   2 months ago   13.3kB</span><br><span class="line">centos        latest    5d0da3dc9764   2 months ago   231MB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解释</span></span><br><span class="line">REPOSITORY   镜像的仓库源</span><br><span class="line">TAG          镜像的标签</span><br><span class="line">IMAGE ID     镜像的ID</span><br><span class="line">CREATED      镜像的创建时间</span><br><span class="line">SIZE         镜像的大小</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">可选</span></span><br><span class="line">-a, --all             # 列出所有的镜像</span><br><span class="line">-q, --quiet           # 只显示镜像的id</span><br><span class="line">	</span><br><span class="line">docker images -qa     #显示所有镜像的id</span><br></pre></td></tr></table></figure>

<h2 id="Docker-search搜索镜像"><a href="#Docker-search搜索镜像" class="headerlink" title="Docker search搜索镜像"></a>Docker search搜索镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker search mysql</span><br><span class="line">NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                             MySQL is a widely used, open-source relation…   11728     [OK]       </span><br><span class="line">mariadb                           MariaDB Server is a high performing open sou…   4472      [OK]       </span><br><span class="line">mysql/mysql-server                Optimized MySQL Server Docker images. Create…   872                  [OK]</span><br><span class="line">percona                           Percona Server is a fork of the MySQL relati…   564       [OK]       </span><br><span class="line">phpmyadmin                        phpMyAdmin - A web interface for MySQL and M…   381       [OK]       </span><br><span class="line">centos/mysql-57-centos7           MySQL 5.7 SQL database server                   92                   </span><br><span class="line">mysql/mysql-cluster               Experimental MySQL Cluster Docker images. Cr…   89                   </span><br><span class="line">centurylink/mysql                 Image containing mysql. Optimized to be link…   59                   [OK]</span><br><span class="line">databack/mysql-backup             Back up mysql databases to... anywhere!         53                   </span><br><span class="line">prom/mysqld-exporter                                                              43                   [OK]</span><br><span class="line">deitch/mysql-backup               REPLACED! Please use http://hub.docker.com/r…   41                   [OK]</span><br><span class="line">tutum/mysql                       Base docker image to run a MySQL database se…   35                   </span><br><span class="line">linuxserver/mysql                 A Mysql container, brought to you by LinuxSe…   34                   </span><br><span class="line">schickling/mysql-backup-s3        Backup MySQL to S3 (supports periodic backup…   31                   [OK]</span><br><span class="line">mysql/mysql-router                MySQL Router provides transparent routing be…   23                   </span><br><span class="line">centos/mysql-56-centos7           MySQL 5.6 SQL database server                   21                   </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">可选项</span></span><br><span class="line">--filter=STARS=3000   # 搜索出来的镜像就是starts 大于3000的</span><br><span class="line">[root@localhost ~]# docker search mysql --filter=STARS=2000</span><br><span class="line">NAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql     MySQL is a widely used, open-source relation…   11728     [OK]       </span><br><span class="line">mariadb   MariaDB Server is a high performing open sou…   4472      [OK]   </span><br></pre></td></tr></table></figure>

<h2 id="Docker-pull"><a href="#Docker-pull" class="headerlink" title="Docker pull"></a>Docker pull</h2><p>概述：docker pull 就是去Docker Hub上拉取镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker pull [images]       使用Docker Hub最新版本</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker pull [images:tag]   指定版本</span></span><br><span class="line">[root@localhost ~]# docker pull mysql</span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/mysql</span><br><span class="line">a10c77af2613: Pull complete </span><br><span class="line">b76a7eb51ffd: Pull complete </span><br><span class="line">258223f927e4: Pull complete </span><br><span class="line">2d2c75386df9: Pull complete </span><br><span class="line">63e92e4046c9: Pull complete </span><br><span class="line">f5845c731544: Pull complete </span><br><span class="line">bd0401123a9b: Pull complete </span><br><span class="line">3ef07ec35f1a: Pull complete </span><br><span class="line">c93a31315089: Pull complete </span><br><span class="line">3349ed800d44: Pull complete </span><br><span class="line">6d01857ca4c1: Pull complete </span><br><span class="line">4cc13890eda8: Pull complete </span><br><span class="line">Digest: sha256:aeecae58035f3868bf4f00e5fc623630d8b438db9d05f4d8c6538deb14d4c31b</span><br><span class="line">Status: Downloaded newer image for mysql:latest</span><br><span class="line">docker.io/library/mysql:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">等价于</span></span><br><span class="line">docker pull mysql</span><br><span class="line">docker pull docker.io/library/mysql:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">指定版本下载</span></span><br><span class="line">[root@localhost ~]# docker pull mysql:5.7</span><br><span class="line">5.7: Pulling from library/mysql</span><br><span class="line">a10c77af2613: Already exists </span><br><span class="line">b76a7eb51ffd: Already exists </span><br><span class="line">258223f927e4: Already exists </span><br><span class="line">2d2c75386df9: Already exists </span><br><span class="line">63e92e4046c9: Already exists </span><br><span class="line">f5845c731544: Already exists </span><br><span class="line">bd0401123a9b: Already exists </span><br><span class="line">2724b2da64fd: Pull complete </span><br><span class="line">d10a7e9e325c: Pull complete </span><br><span class="line">1c5fd9c3683d: Pull complete </span><br><span class="line">2e35f83a12e9: Pull complete </span><br><span class="line">Digest: sha256:7a3a7b7a29e6fbff433c339fc52245435fa2c308586481f2f92ab1df239d6a29</span><br><span class="line">Status: Downloaded newer image for mysql:5.7</span><br><span class="line">docker.io/library/mysql:5.7</span><br></pre></td></tr></table></figure>

<h2 id="Docker-rmi"><a href="#Docker-rmi" class="headerlink" title="Docker rmi"></a>Docker rmi</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ8vbgc3u6dvwrjyp45lyrZ /]# docker rmi -f 镜像id         # 删除指定的镜像</span><br><span class="line">[root@iZ8vbgc3u6dvwrjyp45lyrZ /]# docker rmi -f 镜像id 镜像id 镜像id 镜像id   # 删除多个镜像</span><br><span class="line">[root@iZ8vbgc3u6dvwrjyp45lyrZ /]# docker rmi -f $(docker images -aq)     # 删除全部的镜像</span><br></pre></td></tr></table></figure>

<h2 id="commit镜像"><a href="#commit镜像" class="headerlink" title="commit镜像"></a>commit镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker commit 提交容器成为一个新的镜像</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">命令和git原理类似</span></span><br><span class="line">docker commit -m=&quot;描述信息&quot; -a=&quot;作者&quot; 容器id 目标镜像名:[TAG]</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker commit -a=&quot;kuangshen&quot; -m=&quot;add webapps app&quot; 60f93f1ad7ca tomcat02:1.0</span><br><span class="line">sha256:bb440d403ffec2fc1c19eaf04302a8452e5834dbfdf995f6a2d4f6b5eb3b937d</span><br></pre></td></tr></table></figure>

<p>若你想保存当前容器的状态，就可以通过commit来实现! 相当于虚拟机的快照</p>
<p>学习总结：理论和实践的结合，才是最好的学习方式！</p>
<p>弱小和无知不是生存的状态，傲慢才是。</p>
<h1 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run 镜像id 新建容器并启动</span><br><span class="line">docker ps 列出所有运行的容器 docker container list</span><br><span class="line">docker rm 容器id 删除指定容器</span><br><span class="line">docker start 容器id #启动容器</span><br><span class="line">docker restart容器id #重启容器</span><br><span class="line">docker stop 容器id #停止当前正在运行的容器</span><br><span class="line">docker kill 容器id #强制停止当前容器</span><br></pre></td></tr></table></figure>

<h2 id="新建容器并启动"><a href="#新建容器并启动" class="headerlink" title="新建容器并启动"></a>新建容器并启动</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">docker run [可选参数] image</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">参数说明</span></span><br><span class="line">--name=&quot;Name&quot;     容器名字   tomcat01   tomcat02，  用来区分容器</span><br><span class="line">-d                后台方式运行</span><br><span class="line">-it               使用交互方式运行，进入容器查看内容</span><br><span class="line">-p                指定容器的端口 -p  8080:8080</span><br><span class="line">    -p   ip:主机端口:容器端口</span><br><span class="line">    -p   主机端口:容器端口（常用）</span><br><span class="line">    -p   容器端口</span><br><span class="line">    容器端口</span><br><span class="line">-p                随机指定端口</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">测试并启动容器   交互启动容器并进入</span></span><br><span class="line">[root@localhost ~]# docker run -it centos /bin/bash</span><br><span class="line">[root@110e6c40994a /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动容器并在后台运行</span></span><br><span class="line"> 命令 docker  run -d 镜像名！</span><br><span class="line">[root@iZ8vbgc3u6dvwrjyp45lyrZ ~]# docker run -d centos </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">问题docker  ps，发现centos停止了</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">常见的坑，docker 容器使用后台运行，就必须要有一个前台进程， docker 发现没有应用，就会自动停止</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">从容器中退出</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方法一，直接退出container,容器会停止</span></span><br><span class="line">[root@110e6c40994a /]# exit</span><br><span class="line">exit</span><br><span class="line">[root@localhost ~]# </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方法二，使用快捷键</span></span><br><span class="line">Ctrl + P + Q # 容器不停止退出</span><br></pre></td></tr></table></figure>

<h2 id="Docker-ps"><a href="#Docker-ps" class="headerlink" title="Docker ps"></a>Docker ps</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker ps命令 <span class="comment">#列出当前正在运行的容器</span></span></span><br><span class="line">    # 列出当前正在运行的容器</span><br><span class="line">-a  # 列出当前正在运行的容器+带出历史运行过的容器</span><br><span class="line">-n=? # 显示最近创建的容器</span><br><span class="line">-q  # 只显示容器的编号</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND       CREATED        STATUS        PORTS     NAMES</span><br><span class="line">556b1a66b2f7   centos    &quot;/bin/bash&quot;   18 hours ago   Up 18 hours             elated_meitner</span><br><span class="line">[root@localhost ~]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND                  CREATED              STATUS                          PORTS     NAMES</span><br><span class="line">1329f640afad   mysql:latest   &quot;docker-entrypoint.s…&quot;   About a minute ago   Exited (1) About a minute ago             elastic_raman</span><br><span class="line">be6e61b3524e   mysql          &quot;docker-entrypoint.s…&quot;   About a minute ago   Exited (1) About a minute ago             goofy_villani</span><br><span class="line">bc7d495d2bb4   mysql:latest   &quot;docker-entrypoint.s…&quot;   2 minutes ago        Exited (1) 2 minutes ago                  infallible_elbakyan</span><br><span class="line">110e6c40994a   centos         &quot;/bin/bash&quot;              6 minutes ago        Exited (0) 5 minutes ago                  competent_neumann</span><br><span class="line">977c7127f270   hello-world    &quot;/hello&quot;                 About an hour ago    Exited (0) About an hour ago              sleepy_mendel</span><br><span class="line">8e643eda579f   hello-world    &quot;/hello&quot;                 About an hour ago    Exited (0) About an hour ago              intelligent_davinci</span><br><span class="line">556b1a66b2f7   centos         &quot;/bin/bash&quot;              18 hours ago         Up 18 hours                               elated_meitner</span><br><span class="line">8754974c4d43   centos         &quot;--name /bin/bash&quot;       18 hours ago         Created                                   elegant_heyrovsky</span><br><span class="line">ea82b811f5e3   centos         &quot;/bin/bash&quot;              18 hours ago         Exited (0) 18 hours ago                   zhangxin</span><br><span class="line">66f777d2625c   centos         &quot;/bin/sh -c &#x27;while t…&quot;   23 hours ago         Exited (137) 18 hours ago                 ecstatic_greider</span><br><span class="line">8756a697c602   centos         &quot;/bin/bash&quot;              23 hours ago         Exited (0) 23 hours ago                   nervous_colden</span><br><span class="line">dbf3369490ea   centos         &quot;/bin/bash&quot;              23 hours ago         Exited (137) 23 hours ago                 boring_shamir</span><br><span class="line">8346e8faea3f   hello-world    &quot;/hello&quot;                 25 hours ago         Exited (0) 25 hours ago                   eloquent_heyrovsk</span><br></pre></td></tr></table></figure>

<h2 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器id     # 删除指定容器，不能删除正在运行的容器，如果要强制删除  </span><br><span class="line">docker rm -f $(docker ps -aq)  # 删除所有的容器</span><br><span class="line">docker ps -a -qlxargs docker rm  # 删除所有的容器   我还没有用过</span><br></pre></td></tr></table></figure>

<h2 id="启动和停止容器的操作"><a href="#启动和停止容器的操作" class="headerlink" title="启动和停止容器的操作"></a><strong>启动和停止容器的操作</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器id     #启动容器</span><br><span class="line">docker restart 容器id  #重启容器</span><br><span class="line">docker stop 容器id      #停止当前正在运行的容器</span><br><span class="line">docker kill 容器id      #强制停止当前容器</span><br></pre></td></tr></table></figure>

<h2 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker logs --help</span><br><span class="line"></span><br><span class="line">Usage:  docker logs [OPTIONS] CONTAINER</span><br><span class="line"></span><br><span class="line">Fetch the logs of a container</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --details        Show extra details provided to logs</span><br><span class="line">  -f, --follow         Follow log output</span><br><span class="line">      --since string   Show logs since timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)</span><br><span class="line">  -n, --tail string    Number of lines to show from the end of the logs (default &quot;all&quot;)</span><br><span class="line">  -t, --timestamps     Show timestamps</span><br><span class="line">      --until string   Show logs before a timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)</span><br><span class="line"></span><br><span class="line">docker logs -f -t --tail  容器，没有日志</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">自己写一段shell脚本，产生日志</span> </span><br><span class="line">docker run -d centos /bin/sh -c &quot;while true;do echo 6666;sleep 1;done&quot; #模拟日志</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES</span><br><span class="line">9d04eea46ab0   centos    &quot;/bin/bash -c &#x27;while…&quot;   6 seconds ago   Up 5 seconds             dazzling_nightingale</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看日志</span></span><br><span class="line">[root@localhost ~]# docker logs --tail=10 9d</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">6666</span><br><span class="line">[root@localhost ~]# docker logs -tf --tail=10 9d</span><br><span class="line">2021-11-26T03:20:29.861637379Z 6666</span><br><span class="line">2021-11-26T03:20:30.865520059Z 6666</span><br><span class="line">2021-11-26T03:20:31.870512842Z 6666</span><br><span class="line">2021-11-26T03:20:32.874254301Z 6666</span><br><span class="line">2021-11-26T03:20:33.879057508Z 6666</span><br><span class="line">2021-11-26T03:20:34.883843639Z 6666</span><br><span class="line">2021-11-26T03:20:35.887065669Z 6666</span><br><span class="line">2021-11-26T03:20:36.890647667Z 6666</span><br><span class="line">2021-11-26T03:20:37.895813196Z 6666</span><br><span class="line">2021-11-26T03:20:38.899177385Z 6666</span><br><span class="line">2021-11-26T03:20:39.904047514Z 6666</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">解释</span></span><br><span class="line">-tf        #显示日志</span><br><span class="line">--tail=number     #要显示日志条数</span><br></pre></td></tr></table></figure>

<h2 id="查看容器中进程信息-ps"><a href="#查看容器中进程信息-ps" class="headerlink" title="查看容器中进程信息 ps"></a><strong>查看容器中进程信息 ps</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令 docker top 容器<span class="built_in">id</span></span></span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES</span><br><span class="line">9d04eea46ab0   centos    &quot;/bin/bash -c &#x27;while…&quot;   8 minutes ago   Up 8 minutes             dazzling_nightingale</span><br><span class="line">[root@localhost ~]# </span><br><span class="line">[root@localhost ~]# docker top 9d</span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                32390               32368               0                   11:18               ?                   00:00:00            /bin/bash -c while true;do echo 6666;sleep 1;done</span><br><span class="line">root                33001               32390               0                   11:27               ?                   00:00:00            /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin/sleep 1</span><br></pre></td></tr></table></figure>

<h2 id="查看容器的元数据"><a href="#查看容器的元数据" class="headerlink" title="查看容器的元数据"></a>查看容器的元数据</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令 docker inspect 容器<span class="built_in">id</span></span></span><br><span class="line">[root@localhost ~]# docker inspect 9d</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;9d04eea46ab0e751f220e6f5719eeb3db2e618b68399df5fb10c6b52bd82a772&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-11-26T03:18:56.039964436Z&quot;,</span><br><span class="line">        &quot;Path&quot;: &quot;/bin/bash&quot;,</span><br><span class="line">        &quot;Args&quot;: [</span><br><span class="line">            &quot;-c&quot;,</span><br><span class="line">            &quot;while true;do echo 6666;sleep 1;done&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;State&quot;: &#123;</span><br><span class="line">            &quot;Status&quot;: &quot;running&quot;,</span><br><span class="line">            &quot;Running&quot;: true,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 32390,</span><br><span class="line">            &quot;ExitCode&quot;: 0,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2021-11-26T03:18:56.466341583Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/9d04eea46ab0e751f220e6f5719eeb3db2e618b68399df5fb10c6b52bd82a772/resolv.conf&quot;,</span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/9d04eea46ab0e751f220e6f5719eeb3db2e618b68399df5fb10c6b52bd82a772/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/9d04eea46ab0e751f220e6f5719eeb3db2e618b68399df5fb10c6b52bd82a772/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/9d04eea46ab0e751f220e6f5719eeb3db2e618b68399df5fb10c6b52bd82a772/9d04eea46ab0e751f220e6f5719eeb3db2e618b68399df5fb10c6b52bd82a772-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/dazzling_nightingale&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: null,</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: null,</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;&#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;CgroupnsMode&quot;: &quot;host&quot;,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                0,</span><br><span class="line">                0</span><br><span class="line">            ],</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: null,</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;KernelMemory&quot;: 0,</span><br><span class="line">            &quot;KernelMemoryTCP&quot;: 0,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: false,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: null,</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/483681cbf069af39175ebd0519c78ca6fcd188a762e89a3c01ab3d8074fe0d87-init/diff:/var/lib/docker/overlay2/fc151282be9ea1621e43627479b13960654a9f8e540a1afc7fb3951efbf3f9dd/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/483681cbf069af39175ebd0519c78ca6fcd188a762e89a3c01ab3d8074fe0d87/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/483681cbf069af39175ebd0519c78ca6fcd188a762e89a3c01ab3d8074fe0d87/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/483681cbf069af39175ebd0519c78ca6fcd188a762e89a3c01ab3d8074fe0d87/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [],</span><br><span class="line">        &quot;Config&quot;: &#123;</span><br><span class="line">            &quot;Hostname&quot;: &quot;9d04eea46ab0&quot;,</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/bin/bash&quot;,</span><br><span class="line">                &quot;-c&quot;,</span><br><span class="line">                &quot;while true;do echo 6666;sleep 1;done&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;centos&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;</span><br><span class="line">                &quot;org.label-schema.build-date&quot;: &quot;20210915&quot;,</span><br><span class="line">                &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;,</span><br><span class="line">                &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;,</span><br><span class="line">                &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;,</span><br><span class="line">                &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;8a9b6a9858c727a344374e00ed1c67ab4a0c56bef4e87057157c220445027f54&quot;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;Ports&quot;: &#123;&#125;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/8a9b6a9858c7&quot;,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;080e119a1abe45dd6991d37788ae3513a5821264a06256cf312647d048ef26c9&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;48cf642d8bdbeeed66be2ec75d991eaa5fa2f7f8bf3cf4be709f6558a0cff124&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;080e119a1abe45dd6991d37788ae3513a5821264a06256cf312647d048ef26c9&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="进入当前正在运行的容器"><a href="#进入当前正在运行的容器" class="headerlink" title="进入当前正在运行的容器"></a><strong>进入当前正在运行的容器</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们通常容器都是使用后台方式运行的，需要进入容器，修改一些配置</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方法一</span></span><br><span class="line">docker exec -it 容器id bashShell</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker exec -it 9d /bin/bash</span><br><span class="line">[root@9d04eea46ab0 /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方法二</span></span><br><span class="line">docker attach 容器id</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试</span></span><br><span class="line">[root@iZ8vbgc3u6dvwrjyp45lyrZ /]# docker attach 596b80f933ac</span><br><span class="line">正在执行当前的代码。。。。</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker <span class="built_in">exec</span>    <span class="comment">#进入容器后开启一个新的终端，可以在里面操作（常用）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker attach  <span class="comment">#进入容器正在执行的终端，不会启动新的进程！</span></span></span><br></pre></td></tr></table></figure>

<h4 id="从容器内拷贝到主机上"><a href="#从容器内拷贝到主机上" class="headerlink" title="从容器内拷贝到主机上"></a><strong>从容器内拷贝到主机上</strong></h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器id:容器内路径   目的的主机路径</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker exec -it 9d /bin/bash        #进入容器</span><br><span class="line">[root@9d04eea46ab0 /]# cd /home/                        </span><br><span class="line">[root@9d04eea46ab0 home]# touch test.txt       创建测试文件</span><br><span class="line">[root@9d04eea46ab0 home]# ls</span><br><span class="line">test.txt</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Ctrl+P+Q 不停止退出容器</span></span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES</span><br><span class="line">9d04eea46ab0   centos    &quot;/bin/bash -c &#x27;while…&quot;   23 minutes ago   Up 23 minutes             dazzling_nightingale</span><br><span class="line">[root@localhost ~]# docker cp 9d04eea46ab0:/home/test.txt /home/</span><br><span class="line">[root@localhost ~]# cd /home/</span><br><span class="line">[root@localhost home]# </span><br><span class="line">[root@localhost home]# ls</span><br><span class="line">test.txt            </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">成功从容器复制文件到主机</span></span><br></pre></td></tr></table></figure>

<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p><img src="https://img-blog.csdnimg.cn/20210720092439814.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1MjIzMTU5NTc0Mg==,size_16,color_FFFFFF,t_70" alt="img"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">attach    Attach to a running container                                  #当前shell下attach连接指定运行镜像</span><br><span class="line">build     Build an image from a Dockerfile                               #通过Dockerfile定制镜像</span><br><span class="line">commit    Create a new image from a containers changes                   #提交当前容器为新的镜像</span><br><span class="line">cp          Copy files/folders from a container to a HOSTDIR or to STDOUT  #从容器中拷贝指定文件或者目录到宿主机中</span><br><span class="line">create    Create a new container                                         #创建一个新的容器，同run 但不启动容器</span><br><span class="line">diff      Inspect changes on a containers filesystem                     #查看docker容器变化</span><br><span class="line">events    Get real time events from the server                           #从docker服务获取容器实时事件</span><br><span class="line">exec      Run a command in a running container                           #在已存在的容器上运行命令</span><br><span class="line">export    Export a containers filesystem as a tar archive                #导出容器的内容流作为一个tar归档文件(对应import)</span><br><span class="line">history   Show the history of an image                                   #展示一个镜像形成历史</span><br><span class="line">images    List images                                                    #列出系统当前镜像</span><br><span class="line">import    Import the contents from a tarball to create a filesystem image  #从tar包中的内容创建一个新的文件系统映像(对应export)</span><br><span class="line">info      Display system-wide information                                #显示系统相关信息</span><br><span class="line">inspect   Return low-level information on a container or image           #查看容器详细信息</span><br><span class="line">kill      Kill a running container                                       #kill指定docker容器</span><br><span class="line">load      Load an image from a tar archive or STDIN                      #从一个tar包中加载一个镜像(对应save)</span><br><span class="line">login     Register or log in to a Docker registry                        #注册或者登陆一个docker源服务器</span><br><span class="line">logout    Log out from a Docker registry                                 #从当前Docker registry退出</span><br><span class="line">logs      Fetch the logs of a container                                  #输出当前容器日志信息</span><br><span class="line">pause     Pause all processes within a container                         #暂停容器</span><br><span class="line">port      List port mappings or a specific mapping for the CONTAINER     #查看映射端口对应的容器内部源端口</span><br><span class="line">ps        List containers                                                #列出容器列表</span><br><span class="line">pull      Pull an image or a repository from a registry                  #从docker镜像源服务器拉取指定镜像或者库镜像</span><br><span class="line">push      Push an image or a repository to a registry                    #推送指定镜像或者库镜像至docker源服务器</span><br><span class="line">rename    Rename a container                                             #重命名容器</span><br><span class="line">restart   Restart a running container                                    #重启运行的容器</span><br><span class="line">rm        Remove one or more containers                                  #移除一个或者多个容器</span><br><span class="line">rmi       Remove one or more images                                      #移除一个或多个镜像(无容器使用该镜像才可以删除，否则需要删除相关容器才可以继续或者-f强制删除)</span><br><span class="line">run       Run a command in a new container                               #创建一个新的容器并运行一个命令</span><br><span class="line">save      Save an image(s) to a tar archive                              #保存一个镜像为一个tar包(对应load)</span><br><span class="line">search    Search the Docker Hub for images                               #在docker hub中搜索镜像</span><br><span class="line">start     Start one or more stopped containers                           #启动容器</span><br><span class="line">stats     Display a live stream of container(s) resource usage statistics  #统计容器使用资源</span><br><span class="line">stop      Stop a running container                                       #停止容器</span><br><span class="line">tag       Tag an image into a repository                                 #给源中镜像打标签</span><br><span class="line">top       Display the running processes of a container                   #查看容器中运行的进程信息</span><br><span class="line">unpause   Unpause all processes within a container                       #取消暂停容器</span><br><span class="line">version   Show the Docker version information                            #查看容器版本号</span><br><span class="line">wait      Block until a container stops, then print its exit code        #截取容器停止时的退出状态值</span><br></pre></td></tr></table></figure>

<h1 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h1><h2 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a><strong>安装nginx</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1. 搜索镜像 search 建议大家去docker hub搜索，可以看到帮助文档</span></span><br><span class="line">[root@localhost home]# docker search niginx</span><br><span class="line">NAME                                DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">abiswas/niginx-basicauth                                                            0                    </span><br><span class="line">28may1988/niginx-demo                                                               0                    </span><br><span class="line">harishaws/niginxdoc                                                                 0                    </span><br><span class="line">ananthunair/niginx_lb                                                               0                    </span><br><span class="line">sanjayfromgomia/niginx-sanjay                                                       0                    </span><br><span class="line">fsada/niginx                                                                        0                    </span><br><span class="line">ketan1990/niginx-with-htmltest                                                      0                    </span><br><span class="line">amit25/niginx                                                                       0                    </span><br><span class="line">michaelhan0106/niginx_with_index                                                    0                    </span><br><span class="line">nileshe/niginx                                                                      0                    </span><br><span class="line">ququlm/niginx                                                                       0                    </span><br><span class="line">sriede/niginx-ubuntu                ubuntu installed nginx and exposed to port 8…   0                    </span><br><span class="line">frausto/ruby-2.1.3-nginx            ruby 2.1.3 with niginx                          0                    </span><br><span class="line">guizesilva/niginx-commit                                                            0                    </span><br><span class="line">allwd/niginx                                                                        0                    </span><br><span class="line">bk201zzz/niginx-demo                                                                0                    </span><br><span class="line">marutkumar48/niginx-alpine1-image                                                   0                    </span><br><span class="line">saladd0dg3r/niginx-with-html                                                        0                    </span><br><span class="line">jeffcoop9/niginx-with-html                                                          0                    </span><br><span class="line">dcnayak/niginx                                                                      0                    </span><br><span class="line">dockercreateimage/niginxtest123                                                     0                    </span><br><span class="line">renegare/nginx                      niginx webserver                                0                    </span><br><span class="line">keerthigaddam/app1_demo             simple niginx with html deploymnet              0                    </span><br><span class="line">min19828257/webb                    niginx image                                    0                    </span><br><span class="line">hyejin19930227/myweb                niginx web service configured by HJLee          0     </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2. 拉取镜像 pull</span></span><br><span class="line">[root@localhost home]# docker pull nginx</span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/nginx</span><br><span class="line">eff15d958d66: Pull complete </span><br><span class="line">1e5351450a59: Pull complete </span><br><span class="line">2df63e6ce2be: Pull complete </span><br><span class="line">9171c7ae368c: Pull complete </span><br><span class="line">020f975acd28: Pull complete </span><br><span class="line">266f639b35ad: Pull complete </span><br><span class="line">Digest: sha256:097c3a0913d7e3a5b01b6c685a60c03632fc7a2b50bc8e35bcaa3691d788226e</span><br><span class="line">Status: Downloaded newer image for nginx:latest</span><br><span class="line">docker.io/library/nginx:latest</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看是否拉取成功</span></span><br><span class="line">[root@localhost home]# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">nginx         latest    ea335eea17ab   8 days ago     141MB</span><br><span class="line">mysql         5.7       8b43c6af2ad0   8 days ago     448MB</span><br><span class="line">mysql         latest    b05128b000dd   8 days ago     516MB</span><br><span class="line">hello-world   latest    feb5d9fea6a5   2 months ago   13.3kB</span><br><span class="line">centos        latest    5d0da3dc9764   2 months ago   231MB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-d 后台运行</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--name 给容器命名</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-p 宿主机端口：容器内部端口</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3. 运行测试</span></span><br><span class="line">[root@localhost home]# docker run -d --name nginx01 -p 3380:80 nginx</span><br><span class="line">1103b2fe08a93967d22162cdd7da9a2b7440933abec8d188ba179cae0caf1c21</span><br><span class="line">[root@localhost home]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                                   NAMES</span><br><span class="line">1103b2fe08a9   nginx     &quot;/docker-entrypoint.…&quot;   55 seconds ago   Up 54 seconds   0.0.0.0:3380-&gt;80/tcp, :::3380-&gt;80/tcp   nginx01</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">测试nginx是否部署成功</span></span><br><span class="line">[root@localhost ~]# curl localhost:3380   </span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">html &#123; color-scheme: light dark; &#125;</span><br><span class="line">body &#123; width: 35em; margin: 0 auto;</span><br><span class="line">font-family: Tahoma, Verdana, Arial, sans-serif; &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br><span class="line">working. Further configuration is required.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;For online documentation and support please refer to</span><br><span class="line">&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br><span class="line">Commercial support is available at</span><br><span class="line">&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入容器</span></span><br><span class="line">[root@localhost ~]# docker exec -it 11 /bin/bash</span><br><span class="line">root@1103b2fe08a9:/# whereis nginx</span><br><span class="line">nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginxdua</span><br></pre></td></tr></table></figure>

<h2 id="端口暴露意示图"><a href="#端口暴露意示图" class="headerlink" title="端口暴露意示图"></a>端口暴露意示图</h2><p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211126142430024.png" alt="image-20211126142430024"></p>
<p>思考一个问题：我们每次修改容器的配置文件 ，都需要进入容器进行修改，这样十分那麻烦，我们要是可以实现在容器外部去配置容器的文件，就可以不用每次修改配置文件都进入到容器内部去，有没有这个功能  -v 数据卷可以不可以去做？</p>
<h2 id="安装tomcat"><a href="#安装tomcat" class="headerlink" title="安装tomcat"></a><strong>安装tomcat</strong></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">官方的使用</span></span><br><span class="line">docker run -it --rm tomcat:9.0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们之前的启动都是后台，停止了容器之后，容器还是可以查到     docker run -it --<span class="built_in">rm</span>，一般用来测试，用完就删除</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">搜索镜像</span></span><br><span class="line">[root@localhost ~]# docker search tomcat</span><br><span class="line">NAME                          DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">tomcat                        Apache Tomcat is an open source implementati…   3183      [OK]       </span><br><span class="line">tomee                         Apache TomEE is an all-Apache Java EE certif…   94        [OK]       </span><br><span class="line">dordoka/tomcat                Ubuntu 14.04, Oracle JDK 8 and Tomcat 8 base…   58                   [OK]</span><br><span class="line">kubeguide/tomcat-app          Tomcat image for Chapter 1                      31                   </span><br><span class="line">consol/tomcat-7.0             Tomcat 7.0.57, 8080, &quot;admin/admin&quot;              18                   [OK]</span><br><span class="line">cloudesire/tomcat             Tomcat server, 6/7/8                            15                   [OK]</span><br><span class="line">aallam/tomcat-mysql           Debian, Oracle JDK, Tomcat &amp; MySQL              13                   [OK]</span><br><span class="line">arm32v7/tomcat                Apache Tomcat is an open source implementati…   11                   </span><br><span class="line">andreptb/tomcat               Debian Jessie based image with Apache Tomcat…   10                   [OK]</span><br><span class="line">rightctrl/tomcat              CentOS , Oracle Java, tomcat application ssl…   7                    [OK]</span><br><span class="line">arm64v8/tomcat                Apache Tomcat is an open source implementati…   6                    </span><br><span class="line">unidata/tomcat-docker         Security-hardened Tomcat Docker container.      5                    [OK]</span><br><span class="line">amd64/tomcat                  Apache Tomcat is an open source implementati…   3                    </span><br><span class="line">jelastic/tomcat               An image of the Tomcat Java application serv…   2                    </span><br><span class="line">oobsri/tomcat8                Testing CI Jobs with different names.           2                    </span><br><span class="line">cfje/tomcat-resource          Tomcat Concourse Resource                       2                    </span><br><span class="line">fabric8/tomcat-8              Fabric8 Tomcat 8 Image                          2                    [OK]</span><br><span class="line">ppc64le/tomcat                Apache Tomcat is an open source implementati…   1                    </span><br><span class="line">picoded/tomcat7               tomcat7 with jre8 and MANAGER_USER / MANAGER…   1                    [OK]</span><br><span class="line">camptocamp/tomcat-logback     Docker image for tomcat with logback integra…   1                    [OK]</span><br><span class="line">99taxis/tomcat7               Tomcat7                                         1                    [OK]</span><br><span class="line">chenyufeng/tomcat-centos      tomcat基于centos6的镜像                              1                    [OK]</span><br><span class="line">secoresearch/tomcat-varnish   Tomcat and Varnish 5.0                          0                    [OK]</span><br><span class="line">softwareplant/tomcat          Tomcat images for jira-cloud testing            0                    [OK]</span><br><span class="line">s390x/tomcat                  Apache Tomcat is an open source implementati…   0                    </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">拉取镜像到本地镜像仓库</span></span><br><span class="line">[root@localhost ~]# docker pull tomcat</span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from library/tomcat</span><br><span class="line">647acf3d48c2: Pull complete </span><br><span class="line">b02967ef0034: Pull complete </span><br><span class="line">e1ad2231829e: Pull complete </span><br><span class="line">5576ce26bf1d: Pull complete </span><br><span class="line">26518d6c686a: Pull complete </span><br><span class="line">cdb1f4e0dbfd: Pull complete </span><br><span class="line">1d872b5136cc: Pull complete </span><br><span class="line">0b9db4d94c97: Pull complete </span><br><span class="line">03ee64d25ffd: Pull complete </span><br><span class="line">45a601314df9: Pull complete </span><br><span class="line">Digest: sha256:93ff3bc7fb766a9bb5bb0d1f925f9d8795594d87e8365164908ddddcdaa75ff4</span><br><span class="line">Status: Downloaded newer image for tomcat:latest</span><br><span class="line">docker.io/library/tomcat:latest</span><br><span class="line">[root@localhost ~]# docker images</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">tomcat        latest    904a98253fbf   7 days ago     680MB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">运行tomcat</span></span><br><span class="line">[root@localhost ~]# docker run -d --name tomcat01 -p3355:8080 tomcat</span><br><span class="line">462274fcc5bba728ffec1d4b284e2a330606457f1d170d021e46ed723575aa31</span><br><span class="line">docker: Error response from daemon: driver failed programming external connectivity on endpoint tomcat01 (0cd4ee80852e4ae808ed8076753d480210f9ec89e02347e3458c073cb6387744):  (iptables failed: iptables --wait -t nat -A DOCKER -p tcp -d 0/0 --dport 3355 -j DNAT --to-destination 172.17.0.4:8080 ! -i docker0: iptables: No chain/target/match by that name.</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">报错了 我无法解决</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">上网查找后，报错是因为firewalld的问题，我之前爸firewalld关掉了，导致docker run 运行失败报错</span></span><br><span class="line">具体原因：https://blog.csdn.net/whatday/article/details/86762264</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">解决后成功run</span></span><br><span class="line">[root@localhost ~]# docker run -p 8888:8080 -d tomcat:9.0</span><br><span class="line">60f93f1ad7ca1fb8c23a20da05c27f12425f862007c545eff31123fdf5cf2bda</span><br><span class="line">[root@localhost ~]# </span><br><span class="line">[root@localhost ~]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE        COMMAND             CREATED         STATUS         PORTS                                       NAMES</span><br><span class="line">60f93f1ad7ca   tomcat:9.0   &quot;catalina.sh run&quot;   4 seconds ago   Up 3 seconds   0.0.0.0:8888-&gt;8080/tcp, :::8888-&gt;8080/tcp   distracted_lovelace</span><br><span class="line">[root@localhost ~]# </span><br><span class="line">[root@localhost ~]# curl localhost:8888</span><br><span class="line">&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 404 – Not Found&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body &#123;font-family:Tahoma,Arial,sans-serif;&#125; h1, h2, h3, b &#123;color:white;background-color:#525D76;&#125; h1 &#123;font-size:22px;&#125; h2 &#123;font-size:16px;&#125; h3 &#123;font-size:14px;&#125; p &#123;font-size:12px;&#125; a &#123;color:black;&#125; .line &#123;height:1px;background-color:#525D76;border:none;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 404 – Not Found&lt;/h1&gt;&lt;hr class=&quot;line&quot; /&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt; Status Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt; The origin server did not find a current representation for the target resource or is not willing to disclose that one exists.&lt;/p&gt;&lt;hr class=&quot;line&quot; /&gt;&lt;h3&gt;Apache Tomcat/9.0.55&lt;/h3&gt;&lt;/body&gt;&lt;/html&gt;[root@localhost ~]# </span><br></pre></td></tr></table></figure>

<h2 id="部署es-kibana"><a href="#部署es-kibana" class="headerlink" title="*部署es+kibana"></a>*<em>部署es+kibana</em></h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1. `# es 暴露的端口很多 </span><br><span class="line">2. `# es 十分耗内存`</span><br><span class="line">3. `# es 的数据一般需要放置到安全目录！挂载`</span><br><span class="line">4. `# --net somenetwork ? 网络配置` </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载启动elasticsearch（Docker一步搞定）</span></span><br><span class="line">docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.6.2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">测试一下elastcsearch是否启动成功</span></span><br><span class="line">[root@localhost ~]# curl localhost:9200</span><br><span class="line">&#123;</span><br><span class="line">  &quot;name&quot; : &quot;b8e4d78708bd&quot;,</span><br><span class="line">  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,</span><br><span class="line">  &quot;cluster_uuid&quot; : &quot;cp71ZzKQSgGsshlABprX6w&quot;,</span><br><span class="line">  &quot;version&quot; : &#123;</span><br><span class="line">    &quot;number&quot; : &quot;7.6.2&quot;,</span><br><span class="line">    &quot;build_flavor&quot; : &quot;default&quot;,</span><br><span class="line">    &quot;build_type&quot; : &quot;docker&quot;,</span><br><span class="line">    &quot;build_hash&quot; : &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,</span><br><span class="line">    &quot;build_date&quot; : &quot;2020-03-26T06:34:37.794943Z&quot;,</span><br><span class="line">    &quot;build_snapshot&quot; : false,</span><br><span class="line">    &quot;lucene_version&quot; : &quot;8.4.0&quot;,</span><br><span class="line">    &quot;minimum_wire_compatibility_version&quot; : &quot;6.8.0&quot;,</span><br><span class="line">    &quot;minimum_index_compatibility_version&quot; : &quot;6.0.0-beta1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">关闭，添加内存的限制，修改配置文件 -e 环境配置修改</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-e ES_JAVA_OPTS=<span class="string">&quot;-Xms64m -Xmx512m&quot;</span>  这是为了限制elasticsearch的内存</span></span><br><span class="line">➜ ~ docker rm -f d73ad2f22dd3</span><br><span class="line">➜ ~ docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms64m -Xmx512m&quot;</span><br><span class="line">elasticsearch:7.6.2</span><br></pre></td></tr></table></figure>



<h1 id="docker可视化"><a href="#docker可视化" class="headerlink" title="docker可视化"></a>docker可视化</h1><p>什么是portainer？</p>
<p>Docker图形化界面管理工具！提供一个后台面板供我们操作！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行如下命令即可 打开可视化服务</span></span><br><span class="line">docker run -d -p 8080:9000 \--restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></pre></td></tr></table></figure>

<p>访问：<a target="_blank" rel="noopener" href="http://ip:8080/">http://ip:8080/</a></p>
<h1 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h1><h2 id="什么是数据卷"><a href="#什么是数据卷" class="headerlink" title="什么是数据卷"></a>什么是数据卷</h2><p>docker理念的回顾</p>
<p>docker的数据都在容器内，所以删除容器，就删除了数据！</p>
<p>这样容器的数据，就很危险。</p>
<p>那么为了避免这种危险，有了容器数据卷技术来实现容器数据的持久化。</p>
<p>就是容器的数据可以同步到容器外面来，保证数据的安全。</p>
<p>这就是卷技术，将目录挂载到linux系统上来！</p>
<p>总结一句话：容器的持久化和同步操作！容器间也是可以数据共享的！</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211129140529694.png" alt="image-20211129140529694"></p>
<h2 id="使用数据卷"><a href="#使用数据卷" class="headerlink" title="使用数据卷"></a>使用数据卷</h2><p>方式一 ：直接使用命令挂载 -v</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-v, --volume list Bind mount a volume</span><br><span class="line">docker run -it -v 主机目录:容器内目录    </span><br><span class="line">[root@iZ8vbgc3u6dvwrjyp45lyrZ home]# docker run -it -v /home/ceshi:/home centos /bin/bash</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过 docker inspect 容器<span class="built_in">id</span> 查看</span></span><br></pre></td></tr></table></figure>

<p>通过命令查看挂载</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211129141954118.png" alt="image-20211129141954118"></p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211129142008688.png" alt="image-20211129142008688"></p>
<p>验证如下图：容器内数据与linux中挂载的对应文件的数据是同步的</p>
<p>就算是删除容器</p>
<p>同步到linux服务器的数据也不会丢失</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211129141626040.png" alt="image-20211129141626040"></p>
<h2 id="实战：安装MySQL"><a href="#实战：安装MySQL" class="headerlink" title="实战：安装MySQL"></a>实战：安装MySQL</h2><p>思考：MySQL数据持久化的问题</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">搜索mysql</span></span><br><span class="line"> docker search mysql</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">拉取mysql</span></span><br><span class="line"> docker search mysql</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行容器,需要做数据挂载 <span class="comment">#安装启动mysql，需要配置密码的，这是要注意点！</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">参考官网hub</span></span><br><span class="line">docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动自己的</span></span><br><span class="line">-d 后台运行</span><br><span class="line">-p 指定映射端口</span><br><span class="line">-v 卷挂载</span><br><span class="line">--name 容器名字</span><br><span class="line"></span><br><span class="line"> docker run -d -p 3306:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动成功之后，我们在本地使用sqlyog来测试一下</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">sqlyog-连接到服务器的3306--和容器内的3306映射</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在本地测试创建一个数据库，查看一下我们映射的路径是否ok！</span></span><br><span class="line"></span><br><span class="line">我这里没有sqlyog，我的目标是快速学习docker 所以这方面 目前也不去钻研了</span><br></pre></td></tr></table></figure>



<h2 id="具名和匿名挂载"><a href="#具名和匿名挂载" class="headerlink" title="具名和匿名挂载"></a>具名和匿名挂载</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匿名名挂载</span></span><br><span class="line"></span><br><span class="line">docker run -d -P --name nginx01 -v /etc/nginx nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过docker volume <span class="built_in">ls</span> 查找容器volume</span></span><br><span class="line">[root@localhost ~]# docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     8b6ffa3487325cdee9df37ce93e25e0598a3eb7f125dff6a8b77bd86df4c1a8d    </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过docker inspect 确认容器volume</span></span><br><span class="line">inspect 容器id 查看容器详细信息</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# docker inspect 4899</span><br><span class="line">  </span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,</span><br><span class="line">                &quot;Name&quot;: &quot;8b6ffa3487325cdee9df37ce93e25e0598a3eb7f125dff6a8b77bd86df4c1a8d&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/8b6ffa3487325cdee9df37ce93e25e0598a3eb7f125dff6a8b77bd86df4c1a8d/_data&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/etc/nginx&quot;,</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这里显示的数据远不止这些，我只是截取了一部分，方便学习</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匿名挂载：-v 只写容器内路径</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">具名挂载</span></span><br><span class="line">-P 大P随机指定端口</span><br><span class="line">-v 卷名：容器内路径</span><br><span class="line">docker run -d -P -name nginx02 -v xiaosheng-nginx:/etc/nginx nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看容器卷信息</span></span><br><span class="line">docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     xiaosheng-nginx</span><br><span class="line"></span><br><span class="line">root@localhost ~]# docker inspect xiaosheng-nginx</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;CreatedAt&quot;: &quot;2021-12-01T18:49:37+08:00&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Labels&quot;: null,</span><br><span class="line">        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/xiaosheng-nginx/_data&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;xiaosheng-nginx&quot;,</span><br><span class="line">        &quot;Options&quot;: null,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>总结</p>
<p>没有指定路径的话，所以容器卷的路径都在&#x2F;var&#x2F;lib&#x2F;docker&#x2F;volumes&#x2F;xxx&#x2F;_data</p>
<p>我们通过具名挂载，方便找到一个卷，如果你想很方便找到一个卷，一定要使用具名挂载</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如何确定是具名挂载还是匿名挂载，还是指定路径挂载！</span></span><br><span class="line">-v 容器内路径   #匿名挂载</span><br><span class="line">-v 卷名:容器内路径      # 具名挂载</span><br><span class="line">-v /宿主机路径:容器路径  # 指定路径挂载！ </span><br></pre></td></tr></table></figure>

<p>扩展：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过-v 容器内路径：ro rw 改变读写权限</span></span><br><span class="line">ro readonly  # 只读</span><br><span class="line">rw readwrite # 可读可写</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">一旦设置了读写权限，容器对我们挂载出来的内容就有限定了！</span></span><br><span class="line">docker run -d -P --name nginx05 -v juming:/etc/nginx:ro nginx</span><br><span class="line">docker run -d -P --name nginx05 -v juming:/etc/nginx:rw nginx</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ro 只要看到ro就说明这个路径只能通过宿主机来操作，容器内部是无法操作！</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="初识Dockerfile"><a href="#初识Dockerfile" class="headerlink" title="初识Dockerfile"></a>初识Dockerfile</h2><p>docker就是用来构建docker镜像的构建文件</p>
<p>通过这个脚本可以生成镜像，镜像是一层一层的，脚本是一个一个命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建一个dockerfile文件，名字可以随机取，建议dockerfile</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">文件中的内容 指令（大写）参数</span></span><br><span class="line">FROM centos</span><br><span class="line"></span><br><span class="line">VOLUME [&quot;/volume01&quot;,&quot;/volume02&quot;]</span><br><span class="line"></span><br><span class="line">CMD echo &quot;---end-------&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这里的每个命令，就是镜像的一层！</span></span><br><span class="line"></span><br><span class="line">-f Dockerfile文件目录</span><br><span class="line">-t 镜像名称：tog</span><br><span class="line">[root@localhost docker-test-volume]# docker build -f /home/docker-test-volume/Dockerfile01 -t xiaosheng-centos:1.0 .</span><br><span class="line">Sending build context to Docker daemon  2.048kB</span><br><span class="line">Step 1/4 : FROM centos</span><br><span class="line">latest: Pulling from library/centos</span><br><span class="line">a1d0c7532777: Already exists </span><br><span class="line">Digest: sha256:a27fd8080b517143cbbbab9dfb7c8571c40d67d534bbdee55bd6c473f432b177</span><br><span class="line">Status: Downloaded newer image for centos:latest</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">5d0da3dc9764</span></span><br><span class="line">Step 2/4 : VOLUME [&quot;/volume01&quot;,&quot;/volume02&quot;]</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> e1f4a8ca21d9</span></span><br><span class="line">Removing intermediate container e1f4a8ca21d9</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">3b7a006c2e4d</span></span><br><span class="line">Step 3/4 : CMD echo &quot;---end-------&quot;</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> b4debb9c5a90</span></span><br><span class="line">Removing intermediate container b4debb9c5a90</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">d143c5fd9935</span></span><br><span class="line">Step 4/4 : CMD /bin/bash</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">Running <span class="keyword">in</span> a39c33494caf</span></span><br><span class="line">Removing intermediate container a39c33494caf</span><br><span class="line"><span class="meta prompt_"> ---&gt; </span><span class="language-bash">f8f5912003f7</span></span><br><span class="line">Successfully built f8f5912003f7</span><br><span class="line">Successfully tagged xiaosheng-centos:1.0</span><br></pre></td></tr></table></figure>

<p>查看镜像</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211201203725899.png" alt="image-20211201203725899"></p>
<p>启动自己创建的镜像，并进入</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211201203754414.png" alt="image-20211201203754414"></p>
<p>这个卷和外部一定有一个同步的目录！</p>
<p><img src="https://img-blog.csdnimg.cn/20210722155132469.png" alt="在这里插入图片描述"></p>
<p>查看一下卷挂载的路径</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211201204039759.png" alt="image-20211201204039759"></p>
<p>测试一下刚才的文件是否同步出去了！</p>
<p>这种方式使用的十分多，因为我们通常会构建自己的镜像！</p>
<p>假设构建镜像时候没有挂载卷，要手动镜像挂载 -v 卷名：容器内路径！</p>
<h2 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h2><p>–volumes-from示意图</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/509123ae482041b594dff90c81dd799c.png" alt="在这里插入图片描述"></p>
<h3 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h3><p>练习概述：启动3个容器</p>
<p>数据卷启动docker01</p>
<p>使用–volumes-from启动docker02、docker03</p>
<p>测试容器中的卷的同步情况</p>
<p>启动第一个容器，通过自己dockerfile制作的镜像启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动容器</span></span><br><span class="line">docker run -it --name docker01 xiaosheng-centos:1.0 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">通过docker inspect 查看挂载的地址</span></span><br><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,</span><br><span class="line">                &quot;Name&quot;: &quot;c91344a525e10e07bfebdfaf700808e1879e10066371fd2457e4be040849b18c&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/c91344a525e10e07bfebdfaf700808e1879e10066371fd2457e4be040849b18c/_data&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/volume01&quot;,</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,</span><br><span class="line">                &quot;Name&quot;: &quot;300eef521d91b4be09b2d321454b2af5da9aca08ebe3135facb2700e87b0ebfc&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/300eef521d91b4be09b2d321454b2af5da9aca08ebe3135facb2700e87b0ebfc/_data&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/volume02&quot;,</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动第二个容器</span></span><br><span class="line">[root@localhost _data]# docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE                  COMMAND                  CREATED          STATUS          PORTS     NAMES</span><br><span class="line">8ccea29b89b2   xiaosheng-centos:1.0   &quot;/bin/sh -c /bin/bash&quot;   25 minutes ago   Up 25 minutes           docker01</span><br><span class="line"></span><br><span class="line">docker run -it --name docker02 --volumes-from docker01 xiaosheng-centos:1.0</span><br></pre></td></tr></table></figure>

<p>验证</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211206184904328.png" alt="image-20211206184904328"></p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211206184955427.png" alt="image-20211206184955427"></p>
<p>结论：发现linux、docker01、docker02上面的volume01、volume02的卷可以完全同步！</p>
<h1 id="docekrfile"><a href="#docekrfile" class="headerlink" title="docekrfile"></a>docekrfile</h1><h2 id="dockerfile介绍"><a href="#dockerfile介绍" class="headerlink" title="dockerfile介绍"></a>dockerfile介绍</h2><p>dockerfile是用来构建docker镜像的文本，命令参数脚本</p>
<p>构建步骤</p>
<p>1、编写一个dockerfile文件</p>
<p>2、docker build构建一个镜像</p>
<p>3、docker run运行这个镜像</p>
<p>4、docker push发布镜像，可以发布到docker hub、阿里云镜像仓库等等</p>
<p><img src="https://img-blog.csdnimg.cn/3e9dde477bcd4f10a93d106af5501e81.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1MjIzMTU5NTc0Mg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/765a0bd85ff947fcb008bfc88ecf9cab.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1MjIzMTU5NTc0Mg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>很多官方镜像都是基础镜像包，很多命令用不了，所以我们通常需要自己去构建镜像！</p>
<h2 id="dockerfile构建过程"><a href="#dockerfile构建过程" class="headerlink" title="dockerfile构建过程"></a>dockerfile构建过程</h2><p>基础知识</p>
<p>1、没改保留关键字（指令），必须是大写</p>
<p>2、执行顺序从上到下</p>
<p>3、每一个指令都会创建提交一个新的镜像层，并提交！</p>
<p><img src="https://img-blog.csdnimg.cn/c40a1beeb33140e687c92a3ef54a0680.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1MjIzMTU5NTc0Mg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>Dockerfile是面向开发的，我们以后要发布项目，做镜像，就需要编写dockerfile文件，这个文件十分简单！</p>
<p>Docker镜像逐渐成企业交付的标准，必须要掌握！</p>
<p>DockerFile：构建文件，定义了一切的步骤，源代码</p>
<p>DockerImages：通过DockerFile构建生成的镜像，最终发布和运行产品。</p>
<p>Docker容器：容器就是镜像运行起来提供服务。</p>
<h2 id="dockerfile常用指令"><a href="#dockerfile常用指令" class="headerlink" title="dockerfile常用指令"></a>dockerfile常用指令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FROM             # 基础镜像，一切从这里开始构建</span><br><span class="line">MAINTAINER        # 镜像是谁写的， 姓名+邮箱</span><br><span class="line">RUN             # 镜像构建的时候需要运行的命令</span><br><span class="line">ADD             # 步骤，tomcat镜像，这个tomcat压缩包！添加内容 添加同目录</span><br><span class="line">WORKDIR         # 镜像的工作目录</span><br><span class="line">VOLUME             # 挂载的目录</span><br><span class="line">EXPOSE             # 保留端口配置</span><br><span class="line">CMD             # 指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代。</span><br><span class="line">ENTRYPOINT         # 指定这个容器启动的时候要运行的命令，可以追加命令</span><br><span class="line">ONBUILD         # 当构建一个被继承 DockerFile 这个时候就会运行ONBUILD的指令，触发指令。</span><br><span class="line">COPY             # 类似ADD，将我们文件拷贝到镜像中</span><br><span class="line">ENV             # 构建的时候设置环境变量！</span><br></pre></td></tr></table></figure>

<h2 id="实战测试"><a href="#实战测试" class="headerlink" title="实战测试"></a>实战测试</h2><p>Docker Hub中 99% 镜像都是从这个基础镜像过来的<code>FROM scratch</code> , 然后配置需要的软件和配置来进行的构建</p>
<p><img src="https://img-blog.csdnimg.cn/1e323c4feaf9415cbc0a79e7e2418c90.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1MjIzMTU5NTc0Mg==,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>用dockerfile创建一个自己的centos</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">编写一个自己的镜像</span></span><br><span class="line">vim mydockerfie</span><br><span class="line"></span><br><span class="line">FROM centos</span><br><span class="line">MAINTAINER xiaosheng&lt;2651344456@qq.com&gt;</span><br><span class="line"></span><br><span class="line">ENV MYPATH /usr/local</span><br><span class="line">WORKDIR $MYPATH</span><br><span class="line">RUN yum -y install vim</span><br><span class="line">RUN yum -y install net-tools</span><br><span class="line">EXPOSE 80</span><br><span class="line">CMD echo $MYPATH</span><br><span class="line">CMD echo &quot;---end---&quot;</span><br><span class="line">CMD /bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、通过这个文件构建镜像</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令 docker build -f 文件路径 -t 镜像名:[tag] .</span></span><br><span class="line">docker build -f mydockerfile-centos -t mydockerfile-centos:1.0 .</span><br><span class="line"></span><br><span class="line">Successfully built 23376267c63a</span><br><span class="line">Successfully tagged mydockerfile-centos:1.0   #构建成功</span><br></pre></td></tr></table></figure>

<p>查看构建的镜像</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211208154613398.png" alt="image-20211208154613398"></p>
<p>我们平时拿到一个镜像，可以研究一下它是怎么做的？</p>
<p>可以通过docker history查看其历史构建信息</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211208155004709.png" alt="image-20211208155004709"></p>
<p>CMD 和 ENTRYPOINT区别</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CMD             # 指定这个容器启动的时候要运行的命令，只有最后一个会生效，可被替代。</span><br><span class="line">ENTRYPOINT         # 指定这个容器启动的时候要运行的命令，可以追加命令</span><br></pre></td></tr></table></figure>

<p>测试CMD</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编写dockerfile文件</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim dockerfile-test-cmd</span></span><br><span class="line">FROM centos</span><br><span class="line">CMD [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">构建镜像</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker build -f dockerfile-test-cmd -t cmd-test:0.1 .</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行镜像</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run cmd-test:0.1</span></span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">想追加一个命令 -l 成为<span class="built_in">ls</span> -al</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run cmd-test:0.1 -l</span></span><br><span class="line">docker: Error response from daemon: OCI runtime create failed:container_linux.go:349: starting container process caused &quot;exec: \&quot;-l\&quot;:executable file not found in $PATH&quot;: unknown.</span><br><span class="line">ERRO[0000] error waiting for container: context canceled</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cmd的情况下 -l 替换了CMD[<span class="string">&quot;ls&quot;</span>,<span class="string">&quot;-l&quot;</span>]。 -l 不是命令所有报错</span></span><br></pre></td></tr></table></figure>

<p>测试ENTRYPOINT</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编写dockerfile文件</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">vim dockerfile-test-entrypoint</span></span><br><span class="line">FROM centos</span><br><span class="line">ENTRYPOINT [&quot;ls&quot;,&quot;-a&quot;]</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run entrypoint-test:0.1</span></span><br><span class="line">.</span><br><span class="line">..</span><br><span class="line">.dockerenv</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">lost+found ...</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">我们的命令，是直接拼接在我们得ENTRYPOINT命令后面的</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run entrypoint-test:0.1 -l</span></span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x 1 root root 4096 May 16 06:32 .</span><br><span class="line">drwxr-xr-x 1 root root 4096 May 16 06:32 ..</span><br><span class="line">-rwxr-xr-x 1 root root 0 May 16 06:32 .dockerenv</span><br><span class="line">lrwxrwxrwx 1 root root 7 May 11 2019 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x 5 root root 340 May 16 06:32 dev</span><br><span class="line">drwxr-xr-x 1 root root 4096 May 16 06:32 etc</span><br><span class="line">drwxr-xr-x 2 root root 4096 May 11 2019 home</span><br><span class="line">lrwxrwxrwx 1 root root 7 May 11 2019 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx 1 root root 9 May 11 2019 lib64 -&gt; usr/lib64 ....</span><br></pre></td></tr></table></figure>

<p>Dockerfile中很多命令都十分的相似，我们需要了解它们的区别，我们最好的学习就是对比他们然后测试效果！</p>
<h1 id="发布自己的镜像"><a href="#发布自己的镜像" class="headerlink" title="发布自己的镜像"></a>发布自己的镜像</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Docker Hub</span><br></pre></td></tr></table></figure>

<p>1、登录<a target="_blank" rel="noopener" href="https://hub.docker.com/%E6%B3%A8%E5%86%8C%E8%87%AA%E5%B7%B1%E7%9A%84%E8%B4%A6%E6%88%B7">https://hub.docker.com/注册自己的账户</a></p>
<p>2、确定这个账户可以登录</p>
<p>3、在我们的服务器上提交自己的镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker login --<span class="built_in">help</span></span></span><br><span class="line">Usage: docker login [OPTIONS] [SERVER]</span><br><span class="line">Log in to a Docker registry.</span><br><span class="line">If no server is specified, the default is defined by the daemon.</span><br><span class="line">Options:</span><br><span class="line">-p, --password string Password</span><br><span class="line">--password-stdin Take the password from stdin</span><br><span class="line">-u, --username string Username</span><br></pre></td></tr></table></figure>

<p>4、提交push镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">push自己的镜像到服务器上！</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker push  镜像：tog</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">给自己的镜像打标签</span></span><br><span class="line">docker tag 容器id 自己编写的名称:tag</span><br></pre></td></tr></table></figure>

<p>阿里云镜像服务上</p>
<p>1、登录阿里云</p>
<p>2、找到容器镜像服务</p>
<p>3、创建命名空间</p>
<p>4、创建容器镜像</p>
<p>看官网 很详细<a target="_blank" rel="noopener" href="https://cr.console.aliyun.com/repository/">https://cr.console.aliyun.com/repository/</a></p>
<p>小结</p>
<p><img src="https://img-blog.csdnimg.cn/ad5af27b75304b8ba2a4bf7a7163a9cd.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3N1MjIzMTU5NTc0Mg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h1 id="docker网络"><a href="#docker网络" class="headerlink" title="docker网络"></a>docker网络</h1><h2 id="理解docker0"><a href="#理解docker0" class="headerlink" title="理解docker0"></a>理解docker0</h2><p>查看docker服务器上的网络</p>
<p>发现三个网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:3a:77:f4 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.174.129/24 brd 192.168.174.255 scope global noprefixroute dynamic ens33</span><br><span class="line">       valid_lft 1178sec preferred_lft 1178sec</span><br><span class="line">    inet6 fe80::d122:b3b8:ba75:7201/64 scope link noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span><br><span class="line">    link/ether 02:42:97:76:90:b3 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::42:97ff:fe76:90b3/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1、为本机回环地址</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2、vmware虚拟机的网卡地址</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3、docker0地址</span></span><br></pre></td></tr></table></figure>

<p>问题：docker是如何处理容器内部的网络访问请求的</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">测试，运行一个tomcat</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run -d --name tomcat01 tomcat</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">ip addr</span> </span><br><span class="line">[root@localhost ~]# ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:3a:77:f4 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.174.129/24 brd 192.168.174.255 scope global noprefixroute dynamic ens33</span><br><span class="line">       valid_lft 1735sec preferred_lft 1735sec</span><br><span class="line">    inet6 fe80::d122:b3b8:ba75:7201/64 scope link noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span><br><span class="line">    link/ether 02:42:97:76:90:b3 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::42:97ff:fe76:90b3/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">7: veth1bbb20f@if6: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master docker0 state UP group default </span><br><span class="line">    link/ether f6:12:4e:b9:62:28 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet6 fe80::f412:4eff:feb9:6228/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">发现多了一个网卡 veth1bbb20f@if6</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我们进入容器内查看</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我创建的容器没有ip addr 命令</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我勇docker inspect 来查看容器内的网络配置</span></span><br><span class="line">docker inspect --format &#x27;&#123;&#123; .NetworkSettings.IPAddress &#125;&#125;&#x27; 866a6b8616f9</span><br><span class="line">172.17.0.2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">思考？ linux能不能ping通容器内部！ 可以 容器内部可以ping通外界吗？ 可以！</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我尝试着给容器安装ping 但是失败了，为了学习进度先不研究</span></span><br></pre></td></tr></table></figure>

<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>1、每创建一个container,docker就会分配一个ip给所创建的container，我们安装了docker，就会有一个docker0，使用的是veth-pair</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bakari/p/10613710.html">https://www.cnblogs.com/bakari/p/10613710.html</a>   veth-pair技术纤细介绍</p>
<p>再次启动一个容器测试</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213153947077.png" alt="image-20211213153947077"></p>
<p>发现linux上又多了一个网卡，那么在新容器内部，肯定也有一个网卡，网卡是成对出现的</p>
<p><strong>veth-pair</strong> 就是一对的虚拟设备接口，他们都是成对出现的，一端连着协议，一端彼此相连，正因为有这个特性 veth-pair 充当一个桥梁，连接各种虚拟网络设备的OpenStac,Docker容器之间的连接，OVS的连接，都是使用evth-pair技术</p>
<p>3、测试tomcat01与tomcat02之间是否可以相互ping通</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">需要给container安装ping命令包</span></span><br><span class="line">1、apt-get update</span><br><span class="line">2、apt install iputils-ping</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">然后就可以使用ping</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ping linux主机</span></span><br><span class="line">[root@localhost ~]# docker exec -it tomcat01 ping 192.168.174.129</span><br><span class="line">PING 192.168.174.129 (192.168.174.129) 56(84) bytes of data.</span><br><span class="line">64 bytes from 192.168.174.129: icmp_seq=1 ttl=64 time=0.062 ms</span><br><span class="line">64 bytes from 192.168.174.129: icmp_seq=2 ttl=64 time=0.186 ms</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ping tomcat02</span></span><br><span class="line">[root@localhost ~]# docker exec -it tomcat01 ping 172.17.0.3</span><br><span class="line">PING 172.17.0.3 (172.17.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.157 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=2 ttl=64 time=0.328 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=3 ttl=64 time=0.186 ms</span><br></pre></td></tr></table></figure>

<p>结论：containers可以ping通linux主机与其他容器</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213170033175.png" alt="image-20211213170033175"></p>
<h2 id="–link"><a href="#–link" class="headerlink" title="–link"></a>–link</h2><p>思考一个场景，编写一个微服务，database&#x3D;ip;   项目不重启，数据库ip换掉，我们希望可以处理这个问题来，可以用名称来访问容器？</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">用tomcat01 ping tomcat02</span></span><br><span class="line">[root@localhost ~]# docker exec -it tomcat01 ping tomcat02</span><br><span class="line">ping: tomcat02: Name or service not known      #ping不同名称</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">如何可以解决呢   事先启动tomcat01、tomcat02、tomcat03</span></span><br><span class="line"></span><br><span class="line">1、tomcat3使用--linxk启动</span><br><span class="line">root@localhost ~]# docker run -d --name tomcat03 --link tomcat02 tomcat-new:1.0</span><br><span class="line">2f2a7e0fb524671f0b4bc3cb4172dfd170484128438354533df66f7319177b4b</span><br><span class="line"></span><br><span class="line">2、使用tomcat03 ping tomcat02   可以</span><br><span class="line">[root@localhost ~]# docker exec -it tomcat03 ping tomcat02</span><br><span class="line">PING tomcat02 (172.17.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from tomcat02 (172.17.0.3): icmp_seq=1 ttl=64 time=0.114 ms</span><br><span class="line">64 bytes from tomcat02 (172.17.0.3): icmp_seq=2 ttl=64 time=0.200 ms</span><br><span class="line"></span><br><span class="line">3、测试反方向可不可以ping通   不可以</span><br><span class="line">[root@localhost ~]# docker exec -it tomcat02 ping tomcat03</span><br><span class="line">ping: tomcat03: Name or service not known</span><br></pre></td></tr></table></figure>





<h2 id="docker-network"><a href="#docker-network" class="headerlink" title="docker network"></a>docker network</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">语法</span><br><span class="line">docker network ls   #查看docker当前网络</span><br><span class="line">[root@localhost ~]# docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">66d701d63b68   bridge    bridge    local</span><br><span class="line">64a27e18cebe   host      host      local</span><br><span class="line">965948f9ac96   none      null      local</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看docker网卡具体信息</span></span><br><span class="line">docker network inspect 66d7    </span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213170239741.png" alt="image-20211213170239741"></p>
<p>–link其实实在tomcat3里面配置了tomcat02的配置</p>
<p>为什么去&#x2F;etc&#x2F;hosts内找呢？因为一般&#x2F;etc&#x2F;hosts内配置访问绑定</p>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看hosts文件</span></span><br><span class="line">[root@localhost ~]# docker exec -it tomcat03 cat /etc/hosts</span><br><span class="line">127.0.0.1	localhost</span><br><span class="line">::1	localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0	ip6-localnet</span><br><span class="line">ff00::0	ip6-mcastprefix</span><br><span class="line">ff02::1	ip6-allnodes</span><br><span class="line">ff02::2	ip6-allrouters</span><br><span class="line">172.17.0.3	tomcat02 cbea23682443    &lt;&lt;==果然在这里指向了tomcat02</span><br><span class="line">172.17.0.4	2f2a7e0fb524</span><br></pre></td></tr></table></figure>
</blockquote>
<p>–link 命令 就是在hosts文件中配置了指向目标容器的一条命令</p>
<h2 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h2><h3 id="查看所有的docker-network"><a href="#查看所有的docker-network" class="headerlink" title="查看所有的docker network"></a>查看所有的docker network</h3><p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213172607773.png" alt="image-20211213172607773"></p>
<p>网络模式</p>
<p>bridge   桥接模式 在docker上搭桥</p>
<p>none      不配置网络</p>
<p>host      主机模式  和主机共享网络</p>
<p>comtainer  容器内网络联通  （用的少，局限性大）</p>
<p>测试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"> #</span><span class="language-bash">如果启动容器时候不配置网卡，是默认给我配置--net bridge的</span></span><br><span class="line"> docker run -d -P --name tomcat01 tomcat</span><br><span class="line">docker run -d -P --name tomcat01 --net bridge tomcat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">docker0 特点</span></span><br><span class="line">1、默认</span><br><span class="line">2、域名不能访问</span><br><span class="line">3、--link可以打通连接</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">我们可以自定义网络</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">-d bridge   桥接 默认也是桥接</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">--gateway   配置网关</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">--subnet    配置子网</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">mynet       名称，根据需求自己配置</span></span><br><span class="line">[root@localhost ~]# docker network create -d bridge --gateway 192.168.0.1 --subnet 192.168.0.0/24 mynet</span><br><span class="line">a65a71e5bb2a850e22d4b81c5f02b4e80199700759eac1b5f030a8f8eb35333f</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213174224888.png" alt="image-20211213174224888"></p>
<p>查看自己网络的详细信息</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213174600244.png" alt="image-20211213174600244"></p>
<p>使用自定义的网络mynet创建容器，创建后再查看docker inspect a6 可以看到由mynet创建的容器网络</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213175104222.png" alt="image-20211213175104222"></p>
<p>自定网络功能非常好</p>
<p>1、可以直接ping 名称，并且是相互的</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213175328930.png" alt="image-20211213175328930"></p>
<p>2、所以也可以ping ip</p>
<p>3、自定义网络已经默认配置好了容器之间对应的关系，所以平时一般推荐使用自定义网络！</p>
<p>好处：</p>
<p>redis -不同的集群使用不同网络-保障集群的健康</p>
<p>mysql-不同的集群使用不同网络-保障集群的健康</p>
<h3 id="网络联通"><a href="#网络联通" class="headerlink" title="网络联通"></a>网络联通</h3><p>模型</p>
<p>问题：在不同网络中的容器怎么样进行网络连接？</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213182538580.png" alt="image-20211213182538580"></p>
<p>直接ping测试</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker exec -it tomat01 ping tomcat03</span><br><span class="line">ping: tomcat03: Name or service not known</span><br><span class="line">报错</span><br></pre></td></tr></table></figure>

<p>怎么做呢</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213183016795.png" alt="image-20211213183016795"></p>
<p>连接一个容器到一个网络</p>
<p>命令用法</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213183458646.png" alt="image-20211213183458646"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">测试 打通 tomcat03 到 mynet</span><br><span class="line">[root@localhost ~]# docker network connect mynet tomcat03</span><br></pre></td></tr></table></figure>

<p>查看docker network inspect a6</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213184132574.png" alt="image-20211213184132574"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">联通后，就是在mynet内添加 tomcat03的网络配置</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">一个容器两个ip</span></span><br></pre></td></tr></table></figure>

<p>测试tomcat03 ping tomat01 tomat02</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213184458911.png" alt="image-20211213184458911"></p>
<p>结论：假设容器需要跨网络访问，就可以用到 docker network connect…….</p>
<h1 id="实战部署redis"><a href="#实战部署redis" class="headerlink" title="实战部署redis"></a>实战部署redis</h1><p>示图</p>
<p> <img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213191105995.png" alt="image-20211213191105995"></p>
<p>1、创建redis网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# docker network create redis-net --subnet 172.19.0.0/24</span><br><span class="line">793c2ba92a5ff47c5178bbfe3fc557f41eb26867c265bbc4a76ed73f03dc93d7</span><br><span class="line">[root@localhost ~]# docker network ls</span><br><span class="line">NETWORK ID     NAME        DRIVER    SCOPE</span><br><span class="line">66d701d63b68   bridge      bridge    local</span><br><span class="line">64a27e18cebe   host        host      local</span><br><span class="line">a65a71e5bb2a   mynet       bridge    local</span><br><span class="line">965948f9ac96   none        null      local</span><br><span class="line">793c2ba92a5f   redis-net   bridge    local</span><br></pre></td></tr></table></figure>

<p>2、使用脚本创建redis</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">for port in $(seq 1 6);\</span><br><span class="line">do \</span><br><span class="line">mkdir -p /mydata/redis/node-$&#123;port&#125;/conf</span><br><span class="line">touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">cat &lt;&lt; EOF &gt;&gt; /mydata/redis/node-$&#123;port&#125;/conf/redis.conf</span><br><span class="line">port 6379</span><br><span class="line">bind 0.0.0.0</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">cluster-announce-ip 172.38.0.1$&#123;port&#125;</span><br><span class="line">cluster-announce-port 6379</span><br><span class="line">cluster-announce-bus-port 16379</span><br><span class="line">appendonly yes</span><br><span class="line">EOF</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">直接粘贴到命令行</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211213191951609.png" alt="image-20211213191951609"></p>
<p>3、启动redis集群，使用for循环启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for port in $(seq 1 6);\</span><br><span class="line">do \</span><br><span class="line">docker run -p 637$&#123;port&#125;:6379 -p 1637$&#123;port&#125;:16379 --name redis-$&#123;port&#125; \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/data:/data \</span><br><span class="line">-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \</span><br><span class="line">-d --net redis-net --ip 172.19.0.1$&#123;port&#125; redis:5.0.9-alpine3.11 redis-server /etc/redis/.conf</span><br><span class="line"></span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>问题</p>
<p>1、使用for循环发现问题，容器创建后，因为没有任务会自动关闭，我手动创建发现容器也会自动关闭</p>
<h1 id="SpriingBoot微服务打包docker镜像"><a href="#SpriingBoot微服务打包docker镜像" class="headerlink" title="SpriingBoot微服务打包docker镜像"></a>SpriingBoot微服务打包docker镜像</h1><p>1、架构spriingboot项目</p>
<p>2、打包应用</p>
<p>3、编写dockerfile</p>
<p>4、构建镜像</p>
<p>5、发布运行！</p>
<h1 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h1><p>如果有很多镜像，比如100个</p>
<p>企业运维需要使用到的技术</p>
<p>docker compose</p>
<p>docker swarm   相当于精简的k8s</p>
<p>CI&#x2F;CD之Jenkins</p>
<h1 id="docker下半场"><a href="#docker下半场" class="headerlink" title="docker下半场"></a>docker下半场</h1><p>所以学习，官网</p>
<h1 id="DockerCompose"><a href="#DockerCompose" class="headerlink" title="DockerCompose"></a>DockerCompose</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Docker</p>
<p>Docker build run 手动操作，单个服务</p>
<p>微服务，100个微服务！依赖关系。</p>
<p>Docker Compose 来轻松高效的管理容器，定义运行多个容器。</p>
<h3 id="官方介绍"><a href="#官方介绍" class="headerlink" title="官方介绍"></a>官方介绍</h3><p>定义、运行   多个容器。</p>
<p>YAML file   配置文件</p>
<p>single command 命令有哪些·</p>
<p>Compose is a tool for defining and running multi-container Docker applications. With Compose, you use a YAML file to configure your application’s services. Then, with a single command, you create and start all the services from your configuration. To learn more about all the features of Compose, see <a target="_blank" rel="noopener" href="https://docs.docker.com/compose/#features">the list of features</a>.</p>
<p>所有的环境都可以使用compose</p>
<p>Compose works in all environments: production, staging, development, testing, as well as CI workflows. You can learn more about each case in <a target="_blank" rel="noopener" href="https://docs.docker.com/compose/#common-use-cases">Common Use Cases</a>.</p>
<p>三步骤</p>
<p>Using Compose is basically a three-step process:</p>
<ul>
<li>Define your app’s environment with a <code>Dockerfile</code> so it can be reproduced anywhere.<ul>
<li>Dockerfile保证我们的项目在任何地方可以运行。</li>
</ul>
</li>
<li>Define the services that make up your app in <code>docker-compose.yml</code> so they can be run together in an isolated environment.<ul>
<li>service   什么服务</li>
<li>docker-compose.yml   这个文件怎么写</li>
</ul>
</li>
<li>Run <code>docker compose up</code> and the <a target="_blank" rel="noopener" href="https://docs.docker.com/compose/cli-command/">Docker compose command</a> starts and runs your entire app. You can alternatively run <code>docker-compose up</code> using the docker-compose binary.<ul>
<li>通过docker compose up 启动项目</li>
</ul>
</li>
</ul>
<p>作用：批量服务编排</p>
<h3 id="狂神的理解"><a href="#狂神的理解" class="headerlink" title="狂神的理解"></a>狂神的理解</h3><p>Compose是Docker的开源项目，需要安装！</p>
<p>Dockerfile让程序在任何地方运行。</p>
<p>Compose重要概念</p>
<p>1、服务services，容器、应用。 （web、redis、mysql……）</p>
<p>2、项目project。就是一组关联的容器。</p>
<h3 id="Compose"><a href="#Compose" class="headerlink" title="Compose"></a>Compose</h3><p><code>docker-compose.yml</code> looks like this:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">version: &quot;3.9&quot;  # optional since v1.27.0</span><br><span class="line">services:</span><br><span class="line">  web:</span><br><span class="line">    build: .</span><br><span class="line">    ports:</span><br><span class="line">      - &quot;5000:5000&quot;</span><br><span class="line">    volumes:</span><br><span class="line">      - .:/code</span><br><span class="line">      - logvolume01:/var/log</span><br><span class="line">    links:</span><br><span class="line">      - redis</span><br><span class="line">  redis:</span><br><span class="line">    image: redis</span><br><span class="line">volumes:</span><br><span class="line">  logvolume01: &#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>1、下载</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">其他地址，速度快一些</span></span><br><span class="line">sudo curl -LO &quot;https://git.daocloud.io/docker/compose/releases/download/1.25.5/docker-compose-&#x27;uname -s&#x27;-&#x27;uname -m&#x27; /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<p>2、授权-这样就可以执行docker compose命令了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<p>3、查看Docker-compose version,如下图所示表示安装成功</p>
<p><img src="C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211215143508787.png" alt="image-20211215143508787"></p>
<h2 id="体验"><a href="#体验" class="headerlink" title="体验"></a>体验</h2><p>官网地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/compose/gettingstarted/">https://docs.docker.com/compose/gettingstarted/</a></p>
<ol>
<li><p>​	创建文件夹composetest</p>
<ol>
<li>~~~shell<br>mkdir composetest<br> cd composetest<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. 创建文件app.py,并复制以下内容到文件内：</span><br><span class="line"></span><br><span class="line">   1. ~~~shell</span><br><span class="line">      import time</span><br><span class="line">      </span><br><span class="line">      import redis</span><br><span class="line">      from flask import Flask</span><br><span class="line">      </span><br><span class="line">      app = Flask(__name__)</span><br><span class="line">      cache = redis.Redis(host=&#x27;redis&#x27;, port=6379)</span><br><span class="line">      </span><br><span class="line">      def get_hit_count():</span><br><span class="line">          retries = 5</span><br><span class="line">          while True:</span><br><span class="line">              try:</span><br><span class="line">                  return cache.incr(&#x27;hits&#x27;)</span><br><span class="line">              except redis.exceptions.ConnectionError as exc:</span><br><span class="line">                  if retries == 0:</span><br><span class="line">                      raise exc</span><br><span class="line">                  retries -= 1</span><br><span class="line">                  time.sleep(0.5)</span><br><span class="line">      </span><br><span class="line">      @app.route(&#x27;/&#x27;)</span><br><span class="line">      def hello():</span><br><span class="line">          count = get_hit_count()</span><br><span class="line">          return &#x27;Hello World! I have been seen &#123;&#125; times.\n&#x27;.format(count)</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>创建文件requirements.txt,并复制以下内容到文件内：</p>
<ol>
<li>~~~shell<br>flask<br>redis<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">4. 创建文件Dockerfile,并复制以下内容到文件内：</span><br><span class="line"></span><br><span class="line">   1. ~~~shell</span><br><span class="line">      # syntax=docker/dockerfile:1</span><br><span class="line">      FROM python:3.7-alpine</span><br><span class="line">      WORKDIR /code</span><br><span class="line">      ENV FLASK_APP=app.py</span><br><span class="line">      ENV FLASK_RUN_HOST=0.0.0.0</span><br><span class="line">      RUN apk add --no-cache gcc musl-dev linux-headers</span><br><span class="line">      COPY requirements.txt requirements.txt</span><br><span class="line">      RUN pip install -r requirements.txt</span><br><span class="line">      EXPOSE 5000</span><br><span class="line">      COPY . .</span><br><span class="line">      CMD [&quot;flask&quot;, &quot;run&quot;]</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p>创建文件docker-compose.yml,并复制以下内容到文件内：</p>
<ol>
<li>~~~shell<br>version: “3.9”<br>services:<br>  web:<br>build: .<br>ports:<br>  - “5000:5000”<br>  redis:<br>image: “redis:alpine”<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">6. 看到下面表示已经成功运行起来</span><br><span class="line"></span><br><span class="line">   ![image-20211216152007531](C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211216152007531.png)</span><br><span class="line"></span><br><span class="line">可以去浏览器上查看显示</span><br><span class="line"></span><br><span class="line">## 网络</span><br><span class="line"></span><br><span class="line">只要通过Docker Compose启动，就会生成一个集群自己的网络</span><br><span class="line"></span><br><span class="line">![image-20211216154833672](C:\Users\张鑫\AppData\Roaming\Typora\typora-user-images\image-20211216154833672.png)</span><br><span class="line"></span><br><span class="line">10个服务==》项目，（项目中的容器都在同一个网络下面，域名访问）</span><br><span class="line"></span><br><span class="line">Docker Compose通过编写yum文件，就可以用一条命令管理所以服务的生命周期！</span><br><span class="line"></span><br><span class="line">## 小结</span><br><span class="line"></span><br><span class="line">1. docker镜像  run==》容器</span><br><span class="line">2. DockerFile 构建镜像 （服务打包）</span><br><span class="line">3. docker-compose 启动项目 （编排、多个微服务/环境）</span><br><span class="line">4. Docker网络</span><br><span class="line"></span><br><span class="line"># yaml规则</span><br><span class="line"></span><br><span class="line">docker-compose.yaml 核心 ！</span><br><span class="line"></span><br><span class="line">~~~shell</span><br><span class="line">3层！</span><br><span class="line"></span><br><span class="line">version:‘’  #版本</span><br><span class="line"></span><br><span class="line">services:   #服务</span><br><span class="line">服务1</span><br><span class="line">  #服务配置</span><br><span class="line">   images</span><br><span class="line">   build</span><br><span class="line">   network</span><br><span class="line">   ......</span><br><span class="line">服务2</span><br><span class="line">  ......</span><br><span class="line">服务3</span><br><span class="line">  ......</span><br><span class="line"></span><br><span class="line">#其他配置 网络、卷、全局规则</span><br><span class="line">volumes:</span><br><span class="line">networks:</span><br><span class="line">configs:</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<p>其他知识：depends_on (依赖)：让安装包（软件&#x2F;服务），安装预定顺序启动</p>
<p>学习要掌握规律。！</p>
<p>只要多写，多看 Compose 配置</p>
<p>1、官网文档</p>
<p><a target="_blank" rel="noopener" href="https://docs.docker.com/compose/compose-file/compose-file-v3/">https://docs.docker.com/compose/compose-file/compose-file-v3/</a></p>
<p>2、开源项目。Compose.yaml</p>
<h2 id="开源项目"><a href="#开源项目" class="headerlink" title="开源项目"></a>开源项目</h2><h3 id="博客"><a href="#博客" class="headerlink" title="博客"></a>博客</h3><p>下载程序、安装数据库、配置……</p>
<p>Docker Compose &#x3D;&#x3D;&gt; 一键式启动</p>
<p>1、下载项目（docker-compose.yaml）</p>
<p>2、如果需要文件（DockerFile）</p>
<p>3、文件准备齐全 （直接一键启动）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">命令得自己去--<span class="built_in">help</span>，自己去敲去体会</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">后台启动</span></span><br><span class="line">docker-compose -d</span><br></pre></td></tr></table></figure>

<h3 id="实站："><a href="#实站：" class="headerlink" title="实站："></a>实站：</h3><ol>
<li>编写自己的微服务</li>
<li>Dockerfile构建镜像</li>
<li>使用docker-compose.yaml 编排项目</li>
<li>丢到服务器 docker-compose up</li>
</ol>
<h3 id="小结-2"><a href="#小结-2" class="headerlink" title="小结"></a>小结</h3><p>未来项目只要有docker-compose文件，按照这个规则，启动容器编排！</p>
<p>公司：docker-compose up直接启动</p>
<p>网上的开源项目：docker-compose 一键式启动</p>
<p>假设项目要重新部署：修改后重新构建</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose --build  #重新构建！</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>工程、服务、容器</p>
<p>项目compose：三层</p>
<ul>
<li><p>工程Project</p>
</li>
<li><p>服务：</p>
</li>
<li><p>容器：运行实列 docker  k8s</p>
</li>
</ul>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/13/docker%E7%AC%94%E8%AE%B0/" data-id="cl4f47vu90001dog9gqqn48g2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2022/06/13/hello-world/" class="article-date">
  <time datetime="2022-06-13T07:39:37.705Z" itemprop="datePublished">2022-06-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2022/06/13/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/06/13/hello-world/" data-id="cl4cgz12t000058g95v5y6umi" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/06/13/%E5%A6%82%E4%BD%95%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/06/13/docker%E7%AC%94%E8%AE%B0/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/06/13/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>